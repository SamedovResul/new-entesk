{"ast":null,"code":"var Rule = function Rule(name, fn, args, modifiers) {\n  this.name = name;\n  this.fn = fn;\n  this.args = args;\n  this.modifiers = modifiers;\n};\n\nRule.prototype._test = function _test(value) {\n  var fn = this.fn;\n\n  try {\n    testAux(this.modifiers.slice(), fn)(value);\n  } catch (ex) {\n    fn = function () {\n      return false;\n    };\n  }\n\n  try {\n    return testAux(this.modifiers.slice(), fn)(value);\n  } catch (ex$1) {\n    return false;\n  }\n};\n\nRule.prototype._check = function _check(value) {\n  try {\n    testAux(this.modifiers.slice(), this.fn)(value);\n  } catch (ex) {\n    if (testAux(this.modifiers.slice(), function (it) {\n      return it;\n    })(false)) {\n      return;\n    }\n  }\n\n  if (!testAux(this.modifiers.slice(), this.fn)(value)) {\n    throw null;\n  }\n};\n\nRule.prototype._testAsync = function _testAsync(value) {\n  var this$1 = this;\n  return new Promise(function (resolve, reject) {\n    testAsyncAux(this$1.modifiers.slice(), this$1.fn)(value).then(function (valid) {\n      if (valid) {\n        resolve(value);\n      } else {\n        reject(null);\n      }\n    }).catch(function (ex) {\n      return reject(ex);\n    });\n  });\n};\n\nfunction pickFn(fn, variant) {\n  if (variant === void 0) variant = 'simple';\n  return typeof fn === 'object' ? fn[variant] : fn;\n}\n\nfunction testAux(modifiers, fn) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAux(modifiers, fn);\n    return modifier.perform(nextFn);\n  } else {\n    return pickFn(fn);\n  }\n}\n\nfunction testAsyncAux(modifiers, fn) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAsyncAux(modifiers, fn);\n    return modifier.performAsync(nextFn);\n  } else {\n    return function (value) {\n      return Promise.resolve(pickFn(fn, 'async')(value));\n    };\n  }\n}\n\nvar Modifier = function Modifier(name, perform, performAsync) {\n  this.name = name;\n  this.perform = perform;\n  this.performAsync = performAsync;\n};\n\nvar ValidationError = /*@__PURE__*/function (Error) {\n  function ValidationError(rule, value, cause, target) {\n    var remaining = [],\n        len = arguments.length - 4;\n\n    while (len-- > 0) remaining[len] = arguments[len + 4];\n\n    Error.call(this, remaining);\n\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ValidationError);\n    }\n\n    this.rule = rule;\n    this.value = value;\n    this.cause = cause;\n    this.target = target;\n  }\n\n  if (Error) ValidationError.__proto__ = Error;\n  ValidationError.prototype = Object.create(Error && Error.prototype);\n  ValidationError.prototype.constructor = ValidationError;\n  return ValidationError;\n}(Error);\n\nvar Context = function Context(chain, nextRuleModifiers) {\n  if (chain === void 0) chain = [];\n  if (nextRuleModifiers === void 0) nextRuleModifiers = [];\n  this.chain = chain;\n  this.nextRuleModifiers = nextRuleModifiers;\n};\n\nContext.prototype._applyRule = function _applyRule(ruleFn, name) {\n  var this$1 = this;\n  return function () {\n    var args = [],\n        len = arguments.length;\n\n    while (len--) args[len] = arguments[len];\n\n    this$1.chain.push(new Rule(name, ruleFn.apply(this$1, args), args, this$1.nextRuleModifiers));\n    this$1.nextRuleModifiers = [];\n    return this$1;\n  };\n};\n\nContext.prototype._applyModifier = function _applyModifier(modifier, name) {\n  this.nextRuleModifiers.push(new Modifier(name, modifier.simple, modifier.async));\n  return this;\n};\n\nContext.prototype._clone = function _clone() {\n  return new Context(this.chain.slice(), this.nextRuleModifiers.slice());\n};\n\nContext.prototype.test = function test(value) {\n  return this.chain.every(function (rule) {\n    return rule._test(value);\n  });\n};\n\nContext.prototype.testAll = function testAll(value) {\n  var err = [];\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      err.push(new ValidationError(rule, value, ex));\n    }\n  });\n  return err;\n};\n\nContext.prototype.check = function check(value) {\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      throw new ValidationError(rule, value, ex);\n    }\n  });\n};\n\nContext.prototype.testAsync = function testAsync(value) {\n  var this$1 = this;\n  return new Promise(function (resolve, reject) {\n    executeAsyncRules(value, this$1.chain.slice(), resolve, reject);\n  });\n};\n\nfunction executeAsyncRules(value, rules, resolve, reject) {\n  if (rules.length) {\n    var rule = rules.shift();\n\n    rule._testAsync(value).then(function () {\n      executeAsyncRules(value, rules, resolve, reject);\n    }, function (cause) {\n      reject(new ValidationError(rule, value, cause));\n    });\n  } else {\n    resolve(value);\n  }\n}\n\nfunction v8n() {\n  return typeof Proxy !== undefined ? proxyContext(new Context()) : proxylessContext(new Context());\n} // Custom rules\n\n\nvar customRules = {};\n\nv8n.extend = function (newRules) {\n  Object.assign(customRules, newRules);\n};\n\nv8n.clearCustomRules = function () {\n  customRules = {};\n};\n\nfunction proxyContext(context) {\n  return new Proxy(context, {\n    get: function get(obj, prop) {\n      if (prop in obj) {\n        return obj[prop];\n      }\n\n      var newContext = proxyContext(context._clone());\n\n      if (prop in availableModifiers) {\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n\n      if (prop in customRules) {\n        return newContext._applyRule(customRules[prop], prop);\n      }\n\n      if (prop in availableRules) {\n        return newContext._applyRule(availableRules[prop], prop);\n      }\n    }\n  });\n}\n\nfunction proxylessContext(context) {\n  var addRuleSet = function (ruleSet, targetContext) {\n    Object.keys(ruleSet).forEach(function (prop) {\n      targetContext[prop] = function () {\n        var args = [],\n            len = arguments.length;\n\n        while (len--) args[len] = arguments[len];\n\n        var newContext = proxylessContext(targetContext._clone());\n\n        var contextWithRuleApplied = newContext._applyRule(ruleSet[prop], prop).apply(void 0, args);\n\n        return contextWithRuleApplied;\n      };\n    });\n    return targetContext;\n  };\n\n  var contextWithAvailableRules = addRuleSet(availableRules, context);\n  var contextWithAllRules = addRuleSet(customRules, contextWithAvailableRules);\n  Object.keys(availableModifiers).forEach(function (prop) {\n    Object.defineProperty(contextWithAllRules, prop, {\n      get: function () {\n        var newContext = proxylessContext(contextWithAllRules._clone());\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n    });\n  });\n  return contextWithAllRules;\n}\n\nvar availableModifiers = {\n  not: {\n    simple: function (fn) {\n      return function (value) {\n        return !fn(value);\n      };\n    },\n    async: function (fn) {\n      return function (value) {\n        return Promise.resolve(fn(value)).then(function (result) {\n          return !result;\n        }).catch(function () {\n          return true;\n        });\n      };\n    }\n  },\n  some: {\n    simple: function (fn) {\n      return function (value) {\n        return split(value).some(function (item) {\n          try {\n            return fn(item);\n          } catch (ex) {\n            return false;\n          }\n        });\n      };\n    },\n    async: function (fn) {\n      return function (value) {\n        return Promise.all(split(value).map(function (item) {\n          try {\n            return fn(item).catch(function () {\n              return false;\n            });\n          } catch (ex) {\n            return false;\n          }\n        })).then(function (result) {\n          return result.some(Boolean);\n        });\n      };\n    }\n  },\n  every: {\n    simple: function (fn) {\n      return function (value) {\n        return value !== false && split(value).every(fn);\n      };\n    },\n    async: function (fn) {\n      return function (value) {\n        return Promise.all(split(value).map(fn)).then(function (result) {\n          return result.every(Boolean);\n        });\n      };\n    }\n  }\n};\n\nfunction split(value) {\n  if (typeof value === 'string') {\n    return value.split('');\n  }\n\n  return value;\n}\n\nvar availableRules = {\n  // Value\n  equal: function (expected) {\n    return function (value) {\n      return value == expected;\n    };\n  },\n  exact: function (expected) {\n    return function (value) {\n      return value === expected;\n    };\n  },\n  // Types\n  number: function (allowInfinite) {\n    if (allowInfinite === void 0) allowInfinite = true;\n    return function (value) {\n      return typeof value === 'number' && (allowInfinite || isFinite(value));\n    };\n  },\n  integer: function () {\n    return function (value) {\n      var isInteger = Number.isInteger || isIntegerPolyfill;\n      return isInteger(value);\n    };\n  },\n  numeric: function () {\n    return function (value) {\n      return !isNaN(parseFloat(value)) && isFinite(value);\n    };\n  },\n  string: function () {\n    return testType('string');\n  },\n  boolean: function () {\n    return testType('boolean');\n  },\n  undefined: function () {\n    return testType('undefined');\n  },\n  null: function () {\n    return testType('null');\n  },\n  array: function () {\n    return testType('array');\n  },\n  object: function () {\n    return testType('object');\n  },\n  instanceOf: function (instance) {\n    return function (value) {\n      return value instanceof instance;\n    };\n  },\n  // Pattern\n  pattern: function (expected) {\n    return function (value) {\n      return expected.test(value);\n    };\n  },\n  lowercase: function () {\n    return function (value) {\n      return /^([a-z]+\\s*)+$/.test(value);\n    };\n  },\n  uppercase: function () {\n    return function (value) {\n      return /^([A-Z]+\\s*)+$/.test(value);\n    };\n  },\n  vowel: function () {\n    return function (value) {\n      return /^[aeiou]+$/i.test(value);\n    };\n  },\n  consonant: function () {\n    return function (value) {\n      return /^(?=[^aeiou])([a-z]+)$/i.test(value);\n    };\n  },\n  // Value at\n  first: function (expected) {\n    return function (value) {\n      return value[0] == expected;\n    };\n  },\n  last: function (expected) {\n    return function (value) {\n      return value[value.length - 1] == expected;\n    };\n  },\n  // Length\n  empty: function () {\n    return function (value) {\n      return value.length === 0;\n    };\n  },\n  length: function (min, max) {\n    return function (value) {\n      return value.length >= min && value.length <= (max || min);\n    };\n  },\n  minLength: function (min) {\n    return function (value) {\n      return value.length >= min;\n    };\n  },\n  maxLength: function (max) {\n    return function (value) {\n      return value.length <= max;\n    };\n  },\n  // Range\n  negative: function () {\n    return function (value) {\n      return value < 0;\n    };\n  },\n  positive: function () {\n    return function (value) {\n      return value >= 0;\n    };\n  },\n  between: function (a, b) {\n    return function (value) {\n      return value >= a && value <= b;\n    };\n  },\n  range: function (a, b) {\n    return function (value) {\n      return value >= a && value <= b;\n    };\n  },\n  lessThan: function (n) {\n    return function (value) {\n      return value < n;\n    };\n  },\n  lessThanOrEqual: function (n) {\n    return function (value) {\n      return value <= n;\n    };\n  },\n  greaterThan: function (n) {\n    return function (value) {\n      return value > n;\n    };\n  },\n  greaterThanOrEqual: function (n) {\n    return function (value) {\n      return value >= n;\n    };\n  },\n  // Divisible\n  even: function () {\n    return function (value) {\n      return value % 2 === 0;\n    };\n  },\n  odd: function () {\n    return function (value) {\n      return value % 2 !== 0;\n    };\n  },\n  includes: function (expected) {\n    return function (value) {\n      return ~value.indexOf(expected);\n    };\n  },\n  schema: function (schema) {\n    return testSchema(schema);\n  },\n  // branching\n  passesAnyOf: function () {\n    var validations = [],\n        len = arguments.length;\n\n    while (len--) validations[len] = arguments[len];\n\n    return function (value) {\n      return validations.some(function (validation) {\n        return validation.test(value);\n      });\n    };\n  },\n  optional: function (validation, considerTrimmedEmptyString) {\n    if (considerTrimmedEmptyString === void 0) considerTrimmedEmptyString = false;\n    return function (value) {\n      if (considerTrimmedEmptyString && typeof value === 'string' && value.trim() === '') {\n        return true;\n      }\n\n      if (value !== undefined && value !== null) {\n        validation.check(value);\n      }\n\n      return true;\n    };\n  }\n};\n\nfunction testType(expected) {\n  return function (value) {\n    return Array.isArray(value) && expected === 'array' || value === null && expected === 'null' || typeof value === expected;\n  };\n}\n\nfunction isIntegerPolyfill(value) {\n  return typeof value === 'number' && isFinite(value) && Math.floor(value) === value;\n}\n\nfunction testSchema(schema) {\n  return {\n    simple: function (value) {\n      var causes = [];\n      Object.keys(schema).forEach(function (key) {\n        var nestedValidation = schema[key];\n\n        try {\n          nestedValidation.check((value || {})[key]);\n        } catch (ex) {\n          ex.target = key;\n          causes.push(ex);\n        }\n      });\n\n      if (causes.length > 0) {\n        throw causes;\n      }\n\n      return true;\n    },\n    async: function (value) {\n      var causes = [];\n      var nested = Object.keys(schema).map(function (key) {\n        var nestedValidation = schema[key];\n        return nestedValidation.testAsync((value || {})[key]).catch(function (ex) {\n          ex.target = key;\n          causes.push(ex);\n        });\n      });\n      return Promise.all(nested).then(function () {\n        if (causes.length > 0) {\n          throw causes;\n        }\n\n        return true;\n      });\n    }\n  };\n}\n\nexport default v8n;","map":{"version":3,"sources":["/Users/Gadimlie/Desktop/My-Projects/Entesk-folder/my-app/node_modules/v8n/dist/v8n.esm.js"],"names":["Rule","name","fn","args","modifiers","prototype","_test","value","testAux","slice","ex","ex$1","_check","it","_testAsync","this$1","Promise","resolve","reject","testAsyncAux","then","valid","catch","pickFn","variant","length","modifier","shift","nextFn","perform","performAsync","Modifier","ValidationError","Error","rule","cause","target","remaining","len","arguments","call","captureStackTrace","__proto__","Object","create","constructor","Context","chain","nextRuleModifiers","_applyRule","ruleFn","push","apply","_applyModifier","simple","async","_clone","test","every","testAll","err","forEach","check","testAsync","executeAsyncRules","rules","v8n","Proxy","undefined","proxyContext","proxylessContext","customRules","extend","newRules","assign","clearCustomRules","context","get","obj","prop","newContext","availableModifiers","availableRules","addRuleSet","ruleSet","targetContext","keys","contextWithRuleApplied","contextWithAvailableRules","contextWithAllRules","defineProperty","not","result","some","split","item","all","map","Boolean","equal","expected","exact","number","allowInfinite","isFinite","integer","isInteger","Number","isIntegerPolyfill","numeric","isNaN","parseFloat","string","testType","boolean","null","array","object","instanceOf","instance","pattern","lowercase","uppercase","vowel","consonant","first","last","empty","min","max","minLength","maxLength","negative","positive","between","a","b","range","lessThan","n","lessThanOrEqual","greaterThan","greaterThanOrEqual","even","odd","includes","indexOf","schema","testSchema","passesAnyOf","validations","validation","optional","considerTrimmedEmptyString","trim","Array","isArray","Math","floor","causes","key","nestedValidation","nested"],"mappings":"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","sourcesContent":["var Rule = function Rule(name, fn, args, modifiers) {\n  this.name = name;\n  this.fn = fn;\n  this.args = args;\n  this.modifiers = modifiers;\n};\n\nRule.prototype._test = function _test (value) {\n  var fn = this.fn;\n\n  try {\n    testAux(this.modifiers.slice(), fn)(value);\n  } catch (ex) {\n    fn = function () { return false; };\n  }\n\n  try {\n    return testAux(this.modifiers.slice(), fn)(value);\n  } catch (ex$1) {\n    return false;\n  }\n};\n\nRule.prototype._check = function _check (value) {\n  try {\n    testAux(this.modifiers.slice(), this.fn)(value);\n  } catch (ex) {\n    if (testAux(this.modifiers.slice(), function (it) { return it; })(false)) {\n      return;\n    }\n  }\n\n  if (!testAux(this.modifiers.slice(), this.fn)(value)) {\n    throw null;\n  }\n};\n\nRule.prototype._testAsync = function _testAsync (value) {\n    var this$1 = this;\n\n  return new Promise(function (resolve, reject) {\n    testAsyncAux(\n      this$1.modifiers.slice(),\n      this$1.fn\n    )(value)\n      .then(function (valid) {\n        if (valid) {\n          resolve(value);\n        } else {\n          reject(null);\n        }\n      })\n      .catch(function (ex) { return reject(ex); });\n  });\n};\n\nfunction pickFn(fn, variant) {\n  if ( variant === void 0 ) variant = 'simple';\n\n  return typeof fn === 'object' ? fn[variant] : fn;\n}\n\nfunction testAux(modifiers, fn) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAux(modifiers, fn);\n    return modifier.perform(nextFn);\n  } else {\n    return pickFn(fn);\n  }\n}\n\nfunction testAsyncAux(modifiers, fn) {\n  if (modifiers.length) {\n    var modifier = modifiers.shift();\n    var nextFn = testAsyncAux(modifiers, fn);\n    return modifier.performAsync(nextFn);\n  } else {\n    return function (value) { return Promise.resolve(pickFn(fn, 'async')(value)); };\n  }\n}\n\nvar Modifier = function Modifier(name, perform, performAsync) {\n  this.name = name;\n  this.perform = perform;\n  this.performAsync = performAsync;\n};\n\nvar ValidationError = /*@__PURE__*/(function (Error) {\n  function ValidationError(rule, value, cause, target) {\n    var remaining = [], len = arguments.length - 4;\n    while ( len-- > 0 ) remaining[ len ] = arguments[ len + 4 ];\n\n    Error.call(this, remaining);\n    if (Error.captureStackTrace) {\n      Error.captureStackTrace(this, ValidationError);\n    }\n    this.rule = rule;\n    this.value = value;\n    this.cause = cause;\n    this.target = target;\n  }\n\n  if ( Error ) ValidationError.__proto__ = Error;\n  ValidationError.prototype = Object.create( Error && Error.prototype );\n  ValidationError.prototype.constructor = ValidationError;\n\n  return ValidationError;\n}(Error));\n\nvar Context = function Context(chain, nextRuleModifiers) {\n  if ( chain === void 0 ) chain = [];\n  if ( nextRuleModifiers === void 0 ) nextRuleModifiers = [];\n\n  this.chain = chain;\n  this.nextRuleModifiers = nextRuleModifiers;\n};\n\nContext.prototype._applyRule = function _applyRule (ruleFn, name) {\n    var this$1 = this;\n\n  return function () {\n      var args = [], len = arguments.length;\n      while ( len-- ) args[ len ] = arguments[ len ];\n\n    this$1.chain.push(\n      new Rule(name, ruleFn.apply(this$1, args), args, this$1.nextRuleModifiers)\n    );\n    this$1.nextRuleModifiers = [];\n    return this$1;\n  };\n};\n\nContext.prototype._applyModifier = function _applyModifier (modifier, name) {\n  this.nextRuleModifiers.push(\n    new Modifier(name, modifier.simple, modifier.async)\n  );\n  return this;\n};\n\nContext.prototype._clone = function _clone () {\n  return new Context(this.chain.slice(), this.nextRuleModifiers.slice());\n};\n\nContext.prototype.test = function test (value) {\n  return this.chain.every(function (rule) { return rule._test(value); });\n};\n\nContext.prototype.testAll = function testAll (value) {\n  var err = [];\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      err.push(new ValidationError(rule, value, ex));\n    }\n  });\n  return err;\n};\n\nContext.prototype.check = function check (value) {\n  this.chain.forEach(function (rule) {\n    try {\n      rule._check(value);\n    } catch (ex) {\n      throw new ValidationError(rule, value, ex);\n    }\n  });\n};\n\nContext.prototype.testAsync = function testAsync (value) {\n    var this$1 = this;\n\n  return new Promise(function (resolve, reject) {\n    executeAsyncRules(value, this$1.chain.slice(), resolve, reject);\n  });\n};\n\nfunction executeAsyncRules(value, rules, resolve, reject) {\n  if (rules.length) {\n    var rule = rules.shift();\n    rule._testAsync(value).then(\n      function () {\n        executeAsyncRules(value, rules, resolve, reject);\n      },\n      function (cause) {\n        reject(new ValidationError(rule, value, cause));\n      }\n    );\n  } else {\n    resolve(value);\n  }\n}\n\nfunction v8n() {\n  return typeof Proxy !== undefined\n    ? proxyContext(new Context())\n    : proxylessContext(new Context());\n}\n\n// Custom rules\nvar customRules = {};\n\nv8n.extend = function(newRules) {\n  Object.assign(customRules, newRules);\n};\n\nv8n.clearCustomRules = function() {\n  customRules = {};\n};\n\nfunction proxyContext(context) {\n  return new Proxy(context, {\n    get: function get(obj, prop) {\n      if (prop in obj) {\n        return obj[prop];\n      }\n\n      var newContext = proxyContext(context._clone());\n\n      if (prop in availableModifiers) {\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n      if (prop in customRules) {\n        return newContext._applyRule(customRules[prop], prop);\n      }\n      if (prop in availableRules) {\n        return newContext._applyRule(availableRules[prop], prop);\n      }\n    },\n  });\n}\n\nfunction proxylessContext(context) {\n  var addRuleSet = function (ruleSet, targetContext) {\n    Object.keys(ruleSet).forEach(function (prop) {\n      targetContext[prop] = function () {\n        var args = [], len = arguments.length;\n        while ( len-- ) args[ len ] = arguments[ len ];\n\n        var newContext = proxylessContext(targetContext._clone());\n        var contextWithRuleApplied = newContext._applyRule(\n          ruleSet[prop],\n          prop\n        ).apply(void 0, args);\n        return contextWithRuleApplied;\n      };\n    });\n    return targetContext;\n  };\n\n  var contextWithAvailableRules = addRuleSet(availableRules, context);\n  var contextWithAllRules = addRuleSet(\n    customRules,\n    contextWithAvailableRules\n  );\n\n  Object.keys(availableModifiers).forEach(function (prop) {\n    Object.defineProperty(contextWithAllRules, prop, {\n      get: function () {\n        var newContext = proxylessContext(contextWithAllRules._clone());\n        return newContext._applyModifier(availableModifiers[prop], prop);\n      }\n    });\n  });\n\n  return contextWithAllRules;\n}\n\nvar availableModifiers = {\n  not: {\n    simple: function (fn) { return function (value) { return !fn(value); }; },\n    async: function (fn) { return function (value) { return Promise.resolve(fn(value))\n        .then(function (result) { return !result; })\n        .catch(function () { return true; }); }; },\n  },\n\n  some: {\n    simple: function (fn) { return function (value) {\n      return split(value).some(function (item) {\n        try {\n          return fn(item);\n        } catch (ex) {\n          return false;\n        }\n      });\n    }; },\n    async: function (fn) { return function (value) {\n      return Promise.all(\n        split(value).map(function (item) {\n          try {\n            return fn(item).catch(function () { return false; });\n          } catch (ex) {\n            return false;\n          }\n        })\n      ).then(function (result) { return result.some(Boolean); });\n    }; },\n  },\n\n  every: {\n    simple: function (fn) { return function (value) { return value !== false && split(value).every(fn); }; },\n    async: function (fn) { return function (value) { return Promise.all(split(value).map(fn)).then(function (result) { return result.every(Boolean); }); }; },\n  },\n};\n\nfunction split(value) {\n  if (typeof value === 'string') {\n    return value.split('');\n  }\n  return value;\n}\n\nvar availableRules = {\n  // Value\n\n  equal: function (expected) { return function (value) { return value == expected; }; },\n\n  exact: function (expected) { return function (value) { return value === expected; }; },\n\n  // Types\n\n  number: function (allowInfinite) {\n    if ( allowInfinite === void 0 ) allowInfinite = true;\n\n    return function (value) { return typeof value === 'number' && (allowInfinite || isFinite(value)); };\n},\n\n  integer: function () { return function (value) {\n    var isInteger = Number.isInteger || isIntegerPolyfill;\n    return isInteger(value);\n  }; },\n\n  numeric: function () { return function (value) { return !isNaN(parseFloat(value)) && isFinite(value); }; },\n\n  string: function () { return testType('string'); },\n\n  boolean: function () { return testType('boolean'); },\n\n  undefined: function () { return testType('undefined'); },\n\n  null: function () { return testType('null'); },\n\n  array: function () { return testType('array'); },\n\n  object: function () { return testType('object'); },\n\n  instanceOf: function (instance) { return function (value) { return value instanceof instance; }; },\n\n  // Pattern\n\n  pattern: function (expected) { return function (value) { return expected.test(value); }; },\n\n  lowercase: function () { return function (value) { return /^([a-z]+\\s*)+$/.test(value); }; },\n\n  uppercase: function () { return function (value) { return /^([A-Z]+\\s*)+$/.test(value); }; },\n\n  vowel: function () { return function (value) { return /^[aeiou]+$/i.test(value); }; },\n\n  consonant: function () { return function (value) { return /^(?=[^aeiou])([a-z]+)$/i.test(value); }; },\n\n  // Value at\n\n  first: function (expected) { return function (value) { return value[0] == expected; }; },\n\n  last: function (expected) { return function (value) { return value[value.length - 1] == expected; }; },\n\n  // Length\n\n  empty: function () { return function (value) { return value.length === 0; }; },\n\n  length: function (min, max) { return function (value) { return value.length >= min && value.length <= (max || min); }; },\n\n  minLength: function (min) { return function (value) { return value.length >= min; }; },\n\n  maxLength: function (max) { return function (value) { return value.length <= max; }; },\n\n  // Range\n\n  negative: function () { return function (value) { return value < 0; }; },\n\n  positive: function () { return function (value) { return value >= 0; }; },\n\n  between: function (a, b) { return function (value) { return value >= a && value <= b; }; },\n\n  range: function (a, b) { return function (value) { return value >= a && value <= b; }; },\n\n  lessThan: function (n) { return function (value) { return value < n; }; },\n\n  lessThanOrEqual: function (n) { return function (value) { return value <= n; }; },\n\n  greaterThan: function (n) { return function (value) { return value > n; }; },\n\n  greaterThanOrEqual: function (n) { return function (value) { return value >= n; }; },\n\n  // Divisible\n\n  even: function () { return function (value) { return value % 2 === 0; }; },\n\n  odd: function () { return function (value) { return value % 2 !== 0; }; },\n\n  includes: function (expected) { return function (value) { return ~value.indexOf(expected); }; },\n\n  schema: function (schema) { return testSchema(schema); },\n\n  // branching\n\n  passesAnyOf: function () {\n    var validations = [], len = arguments.length;\n    while ( len-- ) validations[ len ] = arguments[ len ];\n\n    return function (value) { return validations.some(function (validation) { return validation.test(value); }); };\n},\n\n  optional: function (validation, considerTrimmedEmptyString) {\n    if ( considerTrimmedEmptyString === void 0 ) considerTrimmedEmptyString = false;\n\n    return function (value) {\n    if (\n      considerTrimmedEmptyString &&\n      typeof value === 'string' &&\n      value.trim() === ''\n    ) {\n      return true;\n    }\n\n    if (value !== undefined && value !== null) { validation.check(value); }\n    return true;\n  };\n},\n};\n\nfunction testType(expected) {\n  return function (value) {\n    return (\n      (Array.isArray(value) && expected === 'array') ||\n      (value === null && expected === 'null') ||\n      typeof value === expected\n    );\n  };\n}\n\nfunction isIntegerPolyfill(value) {\n  return (\n    typeof value === 'number' && isFinite(value) && Math.floor(value) === value\n  );\n}\n\nfunction testSchema(schema) {\n  return {\n    simple: function (value) {\n      var causes = [];\n      Object.keys(schema).forEach(function (key) {\n        var nestedValidation = schema[key];\n        try {\n          nestedValidation.check((value || {})[key]);\n        } catch (ex) {\n          ex.target = key;\n          causes.push(ex);\n        }\n      });\n      if (causes.length > 0) {\n        throw causes;\n      }\n      return true;\n    },\n    async: function (value) {\n      var causes = [];\n      var nested = Object.keys(schema).map(function (key) {\n        var nestedValidation = schema[key];\n        return nestedValidation.testAsync((value || {})[key]).catch(function (ex) {\n          ex.target = key;\n          causes.push(ex);\n        });\n      });\n      return Promise.all(nested).then(function () {\n        if (causes.length > 0) {\n          throw causes;\n        }\n\n        return true;\n      });\n    },\n  };\n}\n\nexport default v8n;\n"]},"metadata":{},"sourceType":"module"}